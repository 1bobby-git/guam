<!doctype html>
<html lang="ko">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<title>ê´Œ 4ë°•5ì¼ ê°€ì¡±ì—¬í–‰ í”Œë˜ë„ˆ â€” ë°”ë‹¤Â·ìˆ˜ì˜Â·ìµœì†Œì´ë™</title>

<!-- Leaflet (ì§€ë„) -->
<link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css">
<script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>

<style>
  :root{
    --bg:#f8fafc; --card:#ffffff; --ink:#0f172a; --muted:#475569; --line:#e2e8f0;
    --brand:#06b6d4; --brand-2:#38bdf8; --ok:#16a34a; --warn:#f59e0b; --free:#94a3b8; --chip:#e2f6ff;
  }
  *{box-sizing:border-box}
  body{margin:0;background:var(--bg);color:var(--ink);font-family:system-ui,-apple-system,Segoe UI,Roboto,Arial,Apple SD Gothic Neo,Noto Sans KR,Malgun Gothic,sans-serif}
  .wrap{max-width:1180px;margin:24px auto;padding:0 16px}
  h1{font-size:28px;margin:0 0 6px}
  .sub{color:var(--muted);margin-bottom:18px}

  .days{display:flex;gap:8px;flex-wrap:wrap;margin:12px 0 18px}
  .daybtn{border:1px solid var(--line);background:#fff;color:var(--ink);padding:10px 14px;border-radius:10px;cursor:pointer;transition:all .25s;font-weight:600}
  .daybtn:hover{border-color:var(--brand-2);box-shadow:0 2px 10px rgba(56,189,248,.25)}
  .daybtn.active{background:linear-gradient(135deg,#7dd3fc,#22d3ee);color:#052e3f;border-color:transparent}

  .panel{display:none;opacity:0;transform:translateY(8px);transition:opacity .3s ease,transform .3s ease}
  .panel.active{display:block;opacity:1;transform:none}

  .cards{display:grid;grid-template-columns:1.15fr .85fr;gap:16px}
  @media (max-width:980px){.cards{grid-template-columns:1fr}}
  .card{background:var(--card);border:1px solid var(--line);border-radius:16px;box-shadow:0 8px 24px rgba(15,23,42,.06)}
  .card h2{font-size:16px;margin:0;padding:12px 14px;border-bottom:1px solid var(--line);color:#0b2a33}
  .card .body{padding:12px 14px}

  .list{display:flex;flex-direction:column;gap:10px}
  .item{display:flex;justify-content:space-between;gap:8px;padding:12px;border-radius:12px;border:1px solid var(--line);background:#fff;align-items:center;transition:transform .18s,box-shadow .18s,border-color .18s}
  .item:hover{transform:translateY(-1px);box-shadow:0 6px 18px rgba(2,132,199,.12);border-color:#bae6fd}
  .item-left{display:flex;gap:10px;align-items:center;min-width:0}
  .dot{width:10px;height:10px;border-radius:50%;background:var(--brand);box-shadow:0 0 0 4px rgba(34,211,238,.18)}
  .title{font-weight:700;white-space:nowrap;overflow:hidden;text-overflow:ellipsis;max-width:360px}
  .mini{color:var(--muted);font-size:12px}
  .badge{font-size:12px;background:#dcfce7;color:#065f46;border:1px solid #bbf7d0;padding:5px 10px;border-radius:999px;font-weight:700}
  .badge.free{background:#f1f5f9;color:#334155;border-color:#e2e8f0}
  .row-sum{display:flex;gap:10px;flex-wrap:wrap;margin-top:10px}
  .chip{border:1px solid var(--line);background:var(--chip);padding:7px 11px;border-radius:999px;font-size:13px}
  .sum{color:var(--ok);font-weight:800}

  /* ì§€ë„ + ì˜¤ë²„ ì •ë³´ ë‚˜ë€íˆ(ë°ìŠ¤í¬íƒ‘) / ìŠ¤íƒ(ëª¨ë°”ì¼) */
  .mapwrap{display:flex;gap:12px;align-items:stretch}
  #map{flex:1 1 65%; min-height:460px; border-radius:14px; overflow:hidden}
  .hoverdock{flex:0 0 320px; max-height:460px; border:1px solid var(--line); border-radius:14px; background:#fff; box-shadow:0 8px 20px rgba(2,132,199,.08); padding:12px; display:none; overflow:auto}
  .hoverdock.show{display:block}
  .hoverdock h3{margin:0 0 6px;font-size:14px}
  .hoverdock p{margin:0;color:var(--muted);font-size:12px;line-height:1.55}
  @media (max-width:980px){
    .mapwrap{flex-direction:column}
    #map{min-height:420px}
    .hoverdock{flex:unset;max-height:none}
  }

  .map-note{margin-top:8px;color:var(--muted);font-size:12px}

  .sections{margin:22px 0;display:grid;grid-template-columns:1fr 1fr;gap:16px}
  @media (max-width:980px){.sections{grid-template-columns:1fr}}
  .sect h3{margin:0;padding:12px 14px;border-bottom:1px solid var(--line);font-size:15px;color:#0b2a33}
  .sect .body{padding:12px 14px}
  .sect ul{margin:0;padding-left:18px;color:var(--muted);line-height:1.6}
  .sect li{margin:6px 0}
  .kicker{font-size:12px;color:#0b2a33;background:#e0f2fe;border:1px solid #bae6fd;padding:6px 10px;border-radius:999px;display:inline-block;margin-bottom:8px}
  a.link{color:#0284c7;text-decoration:none}
  a.link:hover{text-decoration:underline}
</style>
</head>
<body>
<div class="wrap">
  <h1>ê´Œ 4ë°•5ì¼ ê°€ì¡±ì—¬í–‰ í”Œë˜ë„ˆ</h1>
  <div class="sub">ë‘ì§“íƒ€ë‹ˆ(16â€“18) â†’ ë¡¯ë°í˜¸í…”(18â€“20) Â· ì´ë™ ìµœì†Œ Â· ë°”ë‹¤Â·ìˆ˜ì˜ ì¤‘ì‹¬ Â· ì•„ì¹¨ í¬ì¼€ / ì ì‹¬ í–„ë²„ê±° / ì €ë… BBQ+ë§¥ì£¼</div>

  <div class="days" id="dayControls"></div>
  <div id="panels"></div>

  <div class="cards" style="margin-top:16px">
    <div class="card">
      <h2>ì§€ë„</h2>
      <div class="body">
        <div class="mapwrap">
          <div id="map"></div>
          <!-- ğŸ‘‡ ì˜¤ë²„ ì •ë³´ íŒ¨ë„: ë°ìŠ¤í¬íƒ‘ì—ì„œëŠ” ì§€ë„ ì˜¤ë¥¸ìª½, ëª¨ë°”ì¼ì—ì„œëŠ” ì§€ë„ ì•„ë˜ -->
          <div class="hoverdock" id="hoverDock">
            <h3 id="hoverTitle">ì¥ì†Œ ì •ë³´</h3>
            <p id="hoverText">ë¦¬ìŠ¤íŠ¸/ë§ˆì»¤ ìœ„ì— ë§ˆìš°ìŠ¤ë¥¼ ì˜¬ë¦¬ë©´ ì´ê³³ì— í‘œì‹œë©ë‹ˆë‹¤.</p>
          </div>
        </div>
        <div class="map-note">ë§ˆì»¤ ë˜ëŠ” ì¼ì • í•­ëª©ì— ë§ˆìš°ìŠ¤ë¥¼ ì˜¬ë¦¬ë©´ ì •ë³´ê°€ í‘œì‹œë©ë‹ˆë‹¤. (ì§€ë„ ë“œë˜ê·¸Â·ì¤Œ ë°©í•´ ì—†ìŒ)</div>
      </div>
    </div>

    <div class="card">
      <h2>ì˜ˆì‚°</h2>
      <div class="body"><div id="budgetBox"></div></div>
    </div>
  </div>

  <div class="sections">
    <div class="card sect">
      <h3>ìš´ì „ & êµí†µ</h3>
      <div class="body">
        <span class="kicker">ì£¼ì˜</span>
        <ul>
          <li>ì°¨ ì•ˆì— ê·€ì¤‘í’ˆ/ì§ ë‘ì§€ ì•Šê¸°(ë„ë‚œ ìœ„í—˜). ì¼ë¶€ëŠ” ì•„ì˜ˆ ë¬¸ì„ ì ê·¸ì§€ ë§ë¼ëŠ” ê²½ê³ ë„ ìˆìŒ.</li>
          <li>íŒŒë‘/ë¹¨ê°•ì„  ì£¼ì°¨ê¸ˆì§€, ê°“ê¸¸ ì£¼ì°¨ ê¸ˆì§€, ìŠ¤ì¿¨ë²„ìŠ¤ ìŠ¤íƒ‘ ì‹œ ì£¼í–‰ ê¸ˆì§€.</li>
          <li>í¬íŠ¸í™€(pothole) ì£¼ì˜ â€” ë„ë¡œìƒíƒœ ê³ ë¥´ì§€ ì•Šì„ ìˆ˜ ìˆìŒ.</li>
          <li>ì¤‘ì•™ ì°¨ì„  êµ¬ì¡°ë¡œ ë°˜ëŒ€ì°¨ì„  ì°¨ëŸ‰ ì§„ì… ê°€ëŠ¥ êµ¬ê°„ ì£¼ì˜.</li>
          <li>ì¢ŒÂ·ìš°íšŒì „ ë™ì‹œ ì°¨ì„  ì¡´ì¬.</li>
          <li>STOP í‘œì§€íŒì€ ë°˜ë“œì‹œ 3ì´ˆ ì •ì§€.</li>
          <li>ë ŒíŠ¸ ë°˜ë‚© ì „ ì£¼ìœ  í•„ìˆ˜.</li>
        </ul>
      </div>
    </div>

    <div class="card sect">
      <h3>ì˜ìƒ & ì¤€ë¹„ë¬¼</h3>
      <div class="body">
        <ul>
          <li>ì„ ê¸€ë¼ìŠ¤ í•„ìˆ˜.</li>
          <li>í° ì›í”¼ìŠ¤/í° ì…”ì¸ /ë°ì€ ë°˜ë°”ì§€ ì¶”ì²œ(í•´ë³€/ë¦¬ì¡°íŠ¸ ë¬´ë“œ).</li>
          <li>ìŠµê¸°ì œê±°ì œ, ì¼íšŒìš©ì„¸ì œ, ì„¬ìœ ìœ ì—°ì œ, ë³´ì¡°ë°°í„°ë¦¬, ì•½ìƒì, ìˆ˜ë¶„ì§„ì •íŒ©, ê¹€, ì„¤ê±°ì§€ ìš©í’ˆ, ì‚¼ê°ëŒ€, ì´ì¤‘ë¬¸ì ê¸ˆì¥ì¹˜, ì••ì¶•íŒŒìš°ì¹˜.</li>
          <li>ë¡œì»¬ ë§ˆì¼“ì—ì„œë„ êµ¬ë§¤ ê°€ëŠ¥í•˜ë‚˜, ì†Œëª¨í’ˆì€ ë¯¸ë¦¬ ì¤€ë¹„í•˜ë©´ í¸ë¦¬.</li>
        </ul>
      </div>
    </div>

    <div class="card sect">
      <h3>ì–¸ì–´ & ë¬¸í™”</h3>
      <div class="body">
        <ul>
          <li>ì¸ì‚¬: â€œí•˜íŒŒë°ì´(HÃ¥fa Adai)â€ = ì•ˆë…•í•˜ì„¸ìš”.</li>
          <li>ë§› í‘œí˜„: â€œë©€ë¦­â€ = êµ¿, ë§›ìˆì–´.</li>
          <li>ê°ì‚¬: â€œì”¨ì¥¬ìŠ¤ë§ˆì•„ì”¨â€ = ê³ ë§ˆì›Œìš”.</li>
        </ul>
      </div>
    </div>

    <div class="card sect">
      <h3>ìŒì‹ & ì‹ë‹¹ ì¶”ì²œ</h3>
      <div class="body">
        <ul>
          <li>ë¡œì»¬: Ronâ€™s Diner, Meskla Chamoru Fusion Bistro</li>
          <li>BBQ: Proa</li>
          <li>í–„ë²„ê±°: Meskla Dos</li>
          <li>ë¸ŒëŸ°ì¹˜: Eggs â€™n Things(í‰ê·  ëŒ€ê¸° ì•½ 40ë¶„)</li>
          <li>ì¹´í˜: Mighty Purpleâ€™s, Slow Walk Cafe</li>
          <li>ê°„ë‹¨ì‹/ì‡¼í•‘: Onigiri Seven, Micronesia Mall ë‚´ ì‹ë‹¹</li>
        </ul>
      </div>
    </div>
  </div>
</div>

<script>
  /* ====== ì¼ì •/ì¥ì†Œ/ì˜ˆì‚° ë°ì´í„° ====== */
  var itinerary = [
    {
      day:1, title:"DAY 1 â€” ë„ì°©Â·ë§ˆíŠ¸Â·ìˆ˜ì˜ (ë‘ì§“íƒ€ë‹ˆ)",
      steps:[
        { name:"ë‘ì§“íƒ€ë‹ˆ ì²´í¬ì¸", info:"ì²´í¬ì¸ ë° ì§ ì •ë¦¬", type:"hotel", budget:0, lat:13.5130, lng:144.8070 },
        { name:"K Mart (404 N Marine Dr)", info:"ìƒìˆ˜Â·ê°„ì‹Â·ì•„ì¹¨ìš© í¬ì¼€Â·ë§¥ì£¼ êµ¬ë§¤", type:"market", budget:40, lat:13.4873, lng:144.7820 },
        { name:"Tumon Beach", info:"ì‚°ì±… ë° ê°€ë²¼ìš´ ë¬¼ë†€ì´", type:"beach", budget:0, lat:13.5105, lng:144.8049 },
        { name:"í˜¸í…” ìˆ˜ì˜ì¥", info:"ìœ ì•„í’€ ìœ„ì£¼ ì´ìš©", type:"pool", budget:0, lat:13.5131, lng:144.8072 },
        { name:"Tasi Grill (ë‘ì§“íƒ€ë‹ˆ ë‚´)", info:"ì €ë…: Tasi Burger, Fish & Chips, ë§¥ì£¼", type:"bbq", budget:60, lat:13.5131, lng:144.8072 }
      ]
    },
    {
      day:2, title:"DAY 2 â€” ë°”ë‹¤Â·ìˆ˜ì˜Â·BBQ (ë‘ì§“íƒ€ë‹ˆ)",
      steps:[
        { name:"Onigiri Seven", info:"ì•„ì¹¨: í¬ì¼€ë³¼", type:"poke", budget:20, lat:13.5113, lng:144.8063 },
        { name:"Tumon Beach", info:"ì˜¤ì „ ë¬¼ë†€ì´", type:"beach", budget:0, lat:13.5105, lng:144.8049 },
        { name:"í˜¸í…” ìˆ˜ì˜ì¥", info:"ì ì‹¬ ì „í›„ íœ´ì‹/ìˆ˜ì˜", type:"pool", budget:0, lat:13.5131, lng:144.8072 },
        { name:"Meskla Dos", info:"ì ì‹¬: Badass Burger", type:"burger", budget:35, lat:13.5119, lng:144.8079 },
        { name:"GPO / K Mart", info:"ì˜¤í›„ ì‡¼í•‘Â·ë³´ì¶© êµ¬ë§¤", type:"market", budget:10, lat:13.4867, lng:144.7822 },
        { name:"Proa Restaurant", info:"ì €ë…: BBQ í”Œë˜í„° + ë§¥ì£¼", type:"bbq", budget:70, lat:13.5124, lng:144.8090 }
      ]
    },
    {
      day:3, title:"DAY 3 â€” ìˆ™ì†Œ ì´ë™Â·ì—¬ìœ  (ë¡¯ë°í˜¸í…”)",
      steps:[
        { name:"ë¡¯ë°í˜¸í…” ì²´í¬ì¸", info:"ì²´í¬ì¸ ë° ìˆ˜ì˜/í•´ë³€", type:"hotel", budget:0, lat:13.5161, lng:144.8060 },
        { name:"í˜¸í…” ìˆ˜ì˜ì¥", info:"ì•„ì´ë“¤ê³¼ ìˆ˜ì˜", type:"pool", budget:0, lat:13.5161, lng:144.8060 },
        { name:"Mosaâ€™s", info:"ì ì‹¬: í–„ë²„ê±° + í¬ì¼€ë³¼", type:"burger", budget:40, lat:13.5103, lng:144.8082 },
        { name:"ì†”ë ˆë‹¤ë“œ ìš”ìƒˆ", info:"ê°€ê¹Œìš´ ì „ë§ í¬ì¸íŠ¸ (ì°¨ ì•½ 10ë¶„)", type:"spot", budget:0, lat:13.4653, lng:144.7450 },
        { name:"Ronâ€™s Diner", info:"ì €ë…: ì°¨ëª¨ë¡œ BBQ + ë§¥ì£¼", type:"bbq", budget:65, lat:13.5092, lng:144.8100 }
      ]
    },
    {
      day:4, title:"DAY 4 â€” ìˆ˜ì˜Â·ì¹´í˜Â·ì•¼ì‹œì¥ (ë¡¯ë°í˜¸í…”)",
      steps:[
        { name:"ABC Store (Tumon)", info:"ì•„ì¹¨: í¬ì¼€ë³¼ ë˜ëŠ” ê³¼ì¼ì»µ", type:"poke", budget:20, lat:13.5108, lng:144.8053 },
        { name:"Tumon Beach", info:"í•´ë³€Â·ìŠ¤ë…¸í´Â·ëª¨ë˜ë†€ì´", type:"beach", budget:0, lat:13.5105, lng:144.8049 },
        { name:"ë¡¯ë°í˜¸í…” ìˆ˜ì˜ì¥", info:"ë‚®ì  í›„ ìˆ˜ì˜", type:"pool", budget:0, lat:13.5161, lng:144.8060 },
        { name:"Meskla Chamoru Fusion Bistro", info:"ì ì‹¬: ë¡œì»¬ í”Œë ˆì´íŠ¸ / ë²„ê±°", type:"burger", budget:35, lat:13.5114, lng:144.8072 },
        { name:"Slow Walk Cafe", info:"ì»¤í”¼Â·ë””ì €íŠ¸ (ìŒë£Œ ì–¼ìŒ ì—†ìŒ)", type:"cafe", budget:12, lat:13.5127, lng:144.8058 },
        { name:"Tumon Sunday Night Market", info:"ì €ë…: BBQÂ·ë§¥ì£¼Â·ê°„ì‹", type:"bbq", budget:60, lat:13.5122, lng:144.8044 }
      ]
    },
    {
      day:5, title:"DAY 5 â€” ê·€êµ­ ì¤€ë¹„",
      steps:[
        { name:"ë¡¯ë°í˜¸í…” ì²´í¬ì•„ì›ƒ", info:"ì§ ì •ë¦¬ ë° ì¶œë°œ ì¤€ë¹„", type:"hotel", budget:0, lat:13.5161, lng:144.8060 },
        { name:"K Mart (Tamuning)", info:"ê¸°ë…í’ˆÂ·ê°„ì‹ ë§ˆì§€ë§‰ ì‡¼í•‘", type:"market", budget:15, lat:13.4873, lng:144.7820 },
        { name:"Dream Rent a Car", info:"ë°˜ë‚© ë° ê³µí•­ ì´ë™", type:"spot", budget:0, lat:13.5077, lng:144.8079 }
      ]
    }
  ];

  var controls = document.getElementById('dayControls');
  var panels = document.getElementById('panels');

  function currency(n){ return "$" + n.toFixed(0); }
  function daySum(obj){ var s=0,i; for(i=0;i<obj.steps.length;i++){ s += (obj.steps[i].budget||0); } return s; }
  function totalSum(){ var t=0,i; for(i=0;i<itinerary.length;i++){ t += daySum(itinerary[i]); } return t; }
  function getDay(d){ var i; for(i=0;i<itinerary.length;i++){ if(itinerary[i].day===d) return itinerary[i]; } return itinerary[0]; }

  function makeDayButton(obj, idx){
    var b = document.createElement('button');
    b.className = 'daybtn' + (idx===0?' active':'');
    b.textContent = 'DAY ' + obj.day;
    b.setAttribute('data-day', obj.day);
    b.onclick = function(){ activateDay(obj.day); };
    return b;
  }

  function makePanel(obj, idx){
    var wrap = document.createElement('div');
    wrap.className = 'panel card' + (idx===0?' active':'');
    var h = document.createElement('h2'); h.textContent = obj.title;
    var body = document.createElement('div'); body.className = 'body';
    var list = document.createElement('div'); list.className = 'list';

    var i;
    for(i=0;i<obj.steps.length;i++){
      var s = obj.steps[i];
      var item = document.createElement('div'); item.className = 'item';
      item.setAttribute('data-lat', s.lat); item.setAttribute('data-lng', s.lng);
      item.setAttribute('data-name', s.name); item.setAttribute('data-info', s.info);

      item.onmouseenter = function(e){
        var n = e.currentTarget.getAttribute('data-name');
        var info = e.currentTarget.getAttribute('data-info');
        showHover(n, info, parseFloat(e.currentTarget.getAttribute('data-lat')), parseFloat(e.currentTarget.getAttribute('data-lng')));
      };
      item.onmouseleave = function(){ hideHover(); };

      var left = document.createElement('div'); left.className = 'item-left';
      var dot = document.createElement('span'); dot.className = 'dot';

      var tx = document.createElement('div');
      var ttl = document.createElement('div'); ttl.className='title'; ttl.textContent = s.name;
      var mini = document.createElement('div'); mini.className='mini'; mini.textContent = s.info;
      tx.appendChild(ttl); tx.appendChild(mini);

      left.appendChild(dot); left.appendChild(tx);

      var right = document.createElement('div');
      var tag;
      if(s.budget && s.budget>0){
        tag = document.createElement('span'); tag.className='badge'; tag.textContent = currency(s.budget);
      }else{
        tag = document.createElement('span'); tag.className='badge free'; tag.textContent = 'Free';
      }
      right.appendChild(tag);

      item.appendChild(left); item.appendChild(right);
      list.appendChild(item);
    }

    var row = document.createElement('div'); row.className='row-sum';
    var chip = document.createElement('div'); chip.className='chip';
    chip.innerHTML = '<strong>ì¼ì í•©ê³„</strong> Â· <span class="sum">'+currency(daySum(obj))+'</span>';
    row.appendChild(chip);

    body.appendChild(list); body.appendChild(row);
    wrap.appendChild(h); wrap.appendChild(body);
    return wrap;
  }

  var i;
  for(i=0;i<itinerary.length;i++){ controls.appendChild( makeDayButton(itinerary[i], i) ); }
  for(i=0;i<itinerary.length;i++){ panels.appendChild( makePanel(itinerary[i], i) ); }

  /* ====== ì§€ë„ ====== */
  var map = L.map('map',{ zoomControl:true, scrollWheelZoom:true }).setView([13.511,144.805], 14);
  L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png',{ maxZoom:19, attribution:'Â© OpenStreetMap' }).addTo(map);
  var markerLayer = L.layerGroup().addTo(map);
  var currentMarkers = [];

  function iconByType(t){
    var color = '#06b6d4';
    if(t==='bbq') color='#f59e0b';
    else if(t==='burger') color='#16a34a';
    else if(t==='poke') color='#0ea5e9';
    else if(t==='market') color='#a78bfa';
    else if(t==='hotel') color='#f472b6';
    else if(t==='pool') color='#60a5fa';
    else if(t==='beach') color='#34d399';
    else if(t==='spot') color='#ef4444';
    else if(t==='cafe') color='#94a3b8';

    var html = '<svg xmlns="http://www.w3.org/2000/svg" width="26" height="26" viewBox="0 0 24 24" fill="'+color+'" stroke="black" stroke-width="0.5"><path d="M12 2c3.9 0 7 3.1 7 7 0 5.2-7 13-7 13S5 14.2 5 9c0-3.9 3.1-7 7-7zm0 9.5c1.4 0 2.5-1.1 2.5-2.5S13.4 6.5 12 6.5 9.5 7.6 9.5 9 10.6 11.5 12 11.5z"/></svg>';
    return L.divIcon({ html: html, className:'mkr', iconSize:[26,26], iconAnchor:[13,26], popupAnchor:[0,-20] });
  }

  function loadMarkers(day){
    markerLayer.clearLayers(); currentMarkers = [];
    var obj = getDay(day), bounds = [], i;
    for(i=0;i<obj.steps.length;i++){
      var s = obj.steps[i];
      var m = L.marker([s.lat, s.lng], { icon: iconByType(s.type), title: s.name }).addTo(markerLayer);
      m.bindPopup('<strong>'+s.name+'</strong><br>'+s.info);
      m.on('mouseover', function(e){
        e.target.openPopup();
        showHover(e.target.options.title, e.target.getPopup().getContent().replace(/<[^>]*>?/gm,''), e.target.getLatLng().lat, e.target.getLatLng().lng);
      });
      m.on('mouseout', function(){ hideHover(); });
      currentMarkers.push(m); bounds.push([s.lat, s.lng]);
    }
    if(bounds.length){ map.fitBounds(bounds, { padding:[28,28] }); }
  }

  function focusMarker(lat,lng){
    var i;
    for(i=0;i<currentMarkers.length;i++){
      var p = currentMarkers[i].getLatLng();
      if(Math.abs(p.lat-lat)<0.0009 && Math.abs(p.lng-lng)<0.0009){
        currentMarkers[i].openPopup();
        map.panTo([lat,lng], { animate:true, duration:.35 });
        break;
      }
    }
  }

  /* ====== ì˜ˆì‚° ====== */
  function renderBudget(day){
    var box = document.getElementById('budgetBox');
    var obj = getDay(day);
    var i, html = '';
    html += '<div class="row-sum">';
    for(i=0;i<obj.steps.length;i++){
      var s = obj.steps[i];
      if(s.budget && s.budget>0){
        html += '<div class="chip"><strong>'+s.name+'</strong> Â· '+currency(s.budget)+'</div>';
      }
    }
    html += '</div>';
    html += '<div class="row-sum"><div class="chip"><strong>DAY '+day+' í•©ê³„</strong> Â· <span class="sum">'+currency(daySum(obj))+'</span></div></div>';
    html += '<div class="row-sum"><div class="chip" style="background:#e8fff2;border-color:#bbf7d0"><strong>ì „ì²´ í•©ê³„</strong> Â· <span class="sum">'+currency(totalSum())+'</span></div></div>';
    box.innerHTML = html;
  }

  /* ====== Hover Info: ì§€ë„ ì˜¤ë¥¸ìª½/ì•„ë˜ ë„í¬ ====== */
  function showHover(title, text, lat, lng){
    var dock = document.getElementById('hoverDock');
    document.getElementById('hoverTitle').textContent = title;
    document.getElementById('hoverText').textContent = typeof text==='string' ? text : '';
    if(dock.className.indexOf('show')===-1){ dock.className += ' show'; }
    if(typeof lat==='number' && typeof lng==='number'){ focusMarker(lat, lng); }
  }
  function hideHover(){
    var dock = document.getElementById('hoverDock');
    dock.className = dock.className.replace(' show','');
  }

  /* ====== íŒ¨ë„ í™œì„±í™” ====== */
  function activateDay(day){
    var i, btns = document.querySelectorAll('.daybtn'), ps = document.querySelectorAll('.panel');
    for(i=0;i<btns.length;i++){
      if(parseInt(btns[i].getAttribute('data-day'),10)===day){ btns[i].classList.add('active'); }
      else{ btns[i].classList.remove('active'); }
    }
    for(i=0;i<ps.length;i++){
      if((i+1)===day){ ps[i].classList.add('active'); }
      else{ ps[i].classList.remove('active'); }
    }
    loadMarkers(day);
    renderBudget(day);
    hideHover();
  }

  /* ì´ˆê¸° ë¡œë“œ */
  (function(){
    var i;
    for(i=0;i<itinerary.length;i++){
      controls.appendChild( makeDayButton(itinerary[i], i) );
    }
    for(i=0;i<itinerary.length;i++){
      panels.appendChild( makePanel(itinerary[i], i) );
    }
    activateDay(1);
  })();
</script>
</body>
</html>
