<!doctype html>
<html lang="ko">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<title>괌 4박5일 가족여행 플래너 — 바다·수영·최소이동</title>

<link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css">
<script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>

<style>
  :root{
    --bg:#f8fafc; --card:#ffffff; --ink:#0f172a; --muted:#475569; --line:#e2e8f0;
    --brand:#06b6d4; --brand-2:#38bdf8; --ok:#16a34a; --warn:#f59e0b; --chip:#e2f6ff;
  }
  *{box-sizing:border-box}
  body{margin:0;background:var(--bg);color:var(--ink);font-family:system-ui,-apple-system,Segoe UI,Roboto,Arial,Apple SD Gothic Neo,Noto Sans KR,Malgun Gothic,sans-serif}
  .wrap{max-width:1180px;margin:24px auto;padding:0 16px}
  h1{font-size:28px;margin:0 0 6px}
  .sub{color:var(--muted);margin-bottom:18px}

  .days{display:flex;gap:8px;flex-wrap:wrap;margin:12px 0 18px}
  .daybtn{border:1px solid var(--line);background:#fff;color:var(--ink);padding:10px 14px;border-radius:10px;cursor:pointer;transition:all .25s;font-weight:600}
  .daybtn:hover{border-color:var(--brand-2);box-shadow:0 2px 10px rgba(56,189,248,.25)}
  .daybtn.active{background:linear-gradient(135deg,#7dd3fc,#22d3ee);color:#052e3f;border-color:transparent}

  .panel{display:none;opacity:0;transform:translateY(8px);transition:opacity .3s ease,transform .3s ease}
  .panel.active{display:block;opacity:1;transform:none}

  .cards{display:grid;grid-template-columns:1.15fr .85fr;gap:16px}
  @media (max-width:980px){.cards{grid-template-columns:1fr}}
  .card{background:var(--card);border:1px solid var(--line);border-radius:16px;box-shadow:0 8px 24px rgba(15,23,42,.06)}
  .card h2{font-size:16px;margin:0;padding:12px 14px;border-bottom:1px solid var(--line);color:#0b2a33}
  .card .body{padding:12px 14px}

  .list{display:flex;flex-direction:column;gap:10px}
  .item{display:flex;justify-content:space-between;gap:8px;padding:12px;border-radius:12px;border:1px solid var(--line);background:#fff;align-items:center;transition:transform .18s,box-shadow .18s,border-color .18s}
  .item:hover{transform:translateY(-1px);box-shadow:0 6px 18px rgba(2,132,199,.12);border-color:#bae6fd}
  .item-left{display:flex;gap:10px;align-items:center;min-width:0}
  .dot{width:10px;height:10px;border-radius:50%;background:var(--brand);box-shadow:0 0 0 4px rgba(34,211,238,.18)}
  .title{font-weight:700;white-space:nowrap;overflow:hidden;text-overflow:ellipsis;max-width:360px}
  .mini{color:var(--muted);font-size:12px}
  .badge{font-size:12px;background:#dcfce7;color:#065f46;border:1px solid #bbf7d0;padding:5px 10px;border-radius:999px;font-weight:700}
  .badge.free{background:#f1f5f9;color:#334155;border-color:#e2e8f0}
  .row-sum{display:flex;gap:10px;flex-wrap:wrap;margin-top:10px}
  .chip{border:1px solid var(--line);background:var(--chip);padding:7px 11px;border-radius:999px;font-size:13px}
  .sum{color:var(--ok);font-weight:800}

  .mapwrap{display:flex;gap:12px;align-items:stretch}
  #map{flex:1 1 65%; min-height:460px; border-radius:14px; overflow:hidden}
  .hoverdock{flex:0 0 320px; max-height:460px; border:1px solid var(--line); border-radius:14px; background:#fff; box-shadow:0 8px 20px rgba(2,132,199,.08); padding:12px; display:none; overflow:auto}
  .hoverdock.show{display:block}
  .hoverdock h3{margin:0 0 6px;font-size:14px}
  .hoverdock p{margin:0;color:var(--muted);font-size:12px;line-height:1.55}
  @media (max-width:980px){
    .mapwrap{flex-direction:column}
    #map{min-height:420px}
    .hoverdock{flex:unset;max-height:none}
  }
  .map-note{margin-top:8px;color:var(--muted);font-size:12px}

  .sections{margin:22px 0;display:grid;grid-template-columns:1fr 1fr;gap:16px}
  @media (max-width:980px){.sections{grid-template-columns:1fr}}
  .sect h3{margin:0;padding:12px 14px;border-bottom:1px solid var(--line);font-size:15px;color:#0b2a33}
  .sect .body{padding:12px 14px}
  .sect ul{margin:0;padding-left:18px;color:var(--muted);line-height:1.6}
  .sect li{margin:6px 0}
  .kicker{font-size:12px;color:#0b2a33;background:#e0f2fe;border:1px solid #bae6fd;padding:6px 10px;border-radius:999px;display:inline-block;margin-bottom:8px}
  a.link{color:#0284c7;text-decoration:none}
  a.link:hover{text-decoration:underline}
</style>
</head>
<body>
<div class="wrap">
  <h1>괌 4박5일 가족여행 플래너</h1>
  <div class="sub">두짓타니(16–18) → 롯데호텔(18–20) · 이동 최소 · 바다·수영 중심 · 아침 포케 / 점심 햄버거 / 저녁 BBQ+맥주</div>

  <div class="days" id="dayControls"></div>
  <div id="panels"></div>

  <div class="cards" style="margin-top:16px">
    <div class="card">
      <h2>지도</h2>
      <div class="body">
        <div class="mapwrap">
          <div id="map"></div>
          <div class="hoverdock" id="hoverDock">
            <h3 id="hoverTitle">장소 정보</h3>
            <p id="hoverText">리스트/마커에 마우스를 올리면 이곳에 표시됩니다.</p>
          </div>
        </div>
        <div class="map-note">지도 드래그/줌 방해 없이, 정보 패널은 데스크탑에선 오른쪽·모바일에선 아래 표시됩니다.</div>
      </div>
    </div>

    <div class="card">
      <h2>예산</h2>
      <div class="body"><div id="budgetBox"></div></div>
    </div>
  </div>

  <div class="sections">
    <div class="card sect">
      <h3>운전 & 교통</h3>
      <div class="body">
        <span class="kicker">주의</span>
        <ul>
          <li>차 안에 귀중품/짐 두지 않기(도난 위험). 일부는 아예 문을 잠그지 말라는 경고도 있음.</li>
          <li>파랑/빨강선 주차금지, 갓길 주차 금지, 스쿨버스 스탑 시 주행 금지.</li>
          <li>포트홀(pothole) 주의 — 도로상태 고르지 않을 수 있음.</li>
          <li>중앙 차선 구조로 반대차선 차량 진입 가능 구간 주의.</li>
          <li>좌·우회전 동시 차선 존재.</li>
          <li>STOP 표지판은 반드시 3초 정지.</li>
          <li>렌트 반납 전 주유 필수.</li>
        </ul>
      </div>
    </div>

    <div class="card sect">
      <h3>의상 & 준비물</h3>
      <div class="body">
        <ul>
          <li>선글라스 필수.</li>
          <li>흰 원피스/흰 셔츠/밝은 반바지 추천(해변/리조트 무드).</li>
          <li>습기제거제, 일회용세제, 섬유유연제, 보조배터리, 약상자, 수분진정팩, 김, 설거지 용품, 삼각대, 이중문잠금장치, 압축파우치.</li>
          <li>로컬 마켓에서도 구매 가능하나, 소모품은 미리 준비하면 편리.</li>
        </ul>
      </div>
    </div>

    <div class="card sect">
      <h3>언어 & 문화</h3>
      <div class="body">
        <ul>
          <li>인사: “하파데이(Håfa Adai)” = 안녕하세요.</li>
          <li>맛 표현: “멀릭” = 굿, 맛있어.</li>
          <li>감사: “씨쥬스마아씨” = 고마워요.</li>
        </ul>
      </div>
    </div>

    <div class="card sect">
      <h3>음식 & 식당 추천</h3>
      <div class="body">
        <ul>
          <li>로컬: Ron’s Diner, Meskla Chamoru Fusion Bistro</li>
          <li>BBQ: Proa</li>
          <li>햄버거: Meskla Dos</li>
          <li>브런치: Eggs ’n Things(평균 대기 약 40분)</li>
          <li>카페: Mighty Purple’s, Slow Walk Cafe</li>
          <li>간단식/쇼핑: Onigiri Seven, Micronesia Mall 내 식당</li>
        </ul>
      </div>
    </div>
  </div>
</div>

<script>
  /* ====== 데이터 ====== */
  var itinerary = [
    { day:1, title:"DAY 1 — 도착·마트·수영 (두짓타니)", steps:[
      { name:"두짓타니 체크인", info:"체크인 및 짐 정리", type:"hotel", budget:0, lat:13.5130, lng:144.8070 },
      { name:"K Mart (404 N Marine Dr)", info:"생수·간식·아침용 포케·맥주 구매", type:"market", budget:40, lat:13.4873, lng:144.7820 },
      { name:"Tumon Beach", info:"산책 및 가벼운 물놀이", type:"beach", budget:0, lat:13.5105, lng:144.8049 },
      { name:"호텔 수영장", info:"유아풀 위주 이용", type:"pool", budget:0, lat:13.5131, lng:144.8072 },
      { name:"Tasi Grill (두짓타니 내)", info:"저녁: Tasi Burger, Fish & Chips, 맥주", type:"bbq", budget:60, lat:13.5131, lng:144.8072 }
    ]},
    { day:2, title:"DAY 2 — 바다·수영·BBQ (두짓타니)", steps:[
      { name:"Onigiri Seven", info:"아침: 포케볼", type:"poke", budget:20, lat:13.5113, lng:144.8063 },
      { name:"Tumon Beach", info:"오전 물놀이", type:"beach", budget:0, lat:13.5105, lng:144.8049 },
      { name:"호텔 수영장", info:"점심 전후 휴식/수영", type:"pool", budget:0, lat:13.5131, lng:144.8072 },
      { name:"Meskla Dos", info:"점심: Badass Burger", type:"burger", budget:35, lat:13.5119, lng:144.8079 },
      { name:"GPO / K Mart", info:"오후 쇼핑·보충 구매", type:"market", budget:10, lat:13.4867, lng:144.7822 },
      { name:"Proa Restaurant", info:"저녁: BBQ 플래터 + 맥주", type:"bbq", budget:70, lat:13.5124, lng:144.8090 }
    ]},
    { day:3, title:"DAY 3 — 숙소 이동·여유 (롯데호텔)", steps:[
      { name:"롯데호텔 체크인", info:"체크인 및 수영/해변", type:"hotel", budget:0, lat:13.5161, lng:144.8060 },
      { name:"호텔 수영장", info:"아이들과 수영", type:"pool", budget:0, lat:13.5161, lng:144.8060 },
      { name:"Mosa’s", info:"점심: 햄버거 + 포케볼", type:"burger", budget:40, lat:13.5103, lng:144.8082 },
      { name:"솔레다드 요새", info:"가까운 전망 포인트 (차 약 10분)", type:"spot", budget:0, lat:13.4653, lng:144.7450 },
      { name:"Ron’s Diner", info:"저녁: 차모로 BBQ + 맥주", type:"bbq", budget:65, lat:13.5092, lng:144.8100 }
    ]},
    { day:4, title:"DAY 4 — 수영·카페·야시장 (롯데호텔)", steps:[
      { name:"ABC Store (Tumon)", info:"아침: 포케볼 또는 과일컵", type:"poke", budget:20, lat:13.5108, lng:144.8053 },
      { name:"Tumon Beach", info:"해변·스노클·모래놀이", type:"beach", budget:0, lat:13.5105, lng:144.8049 },
      { name:"롯데호텔 수영장", info:"낮잠 후 수영", type:"pool", budget:0, lat:13.5161, lng:144.8060 },
      { name:"Meskla Chamoru Fusion Bistro", info:"점심: 로컬 플레이트 / 버거", type:"burger", budget:35, lat:13.5114, lng:144.8072 },
      { name:"Slow Walk Cafe", info:"커피·디저트 (음료 얼음 없음)", type:"cafe", budget:12, lat:13.5127, lng:144.8058 },
      { name:"Tumon Sunday Night Market", info:"저녁: BBQ·맥주·간식", type:"bbq", budget:60, lat:13.5122, lng:144.8044 }
    ]},
    { day:5, title:"DAY 5 — 귀국 준비", steps:[
      { name:"롯데호텔 체크아웃", info:"짐 정리 및 출발 준비", type:"hotel", budget:0, lat:13.5161, lng:144.8060 },
      { name:"K Mart (Tamuning)", info:"기념품·간식 마지막 쇼핑", type:"market", budget:15, lat:13.4873, lng:144.7820 },
      { name:"Dream Rent a Car", info:"반납 및 공항 이동", type:"spot", budget:0, lat:13.5077, lng:144.8079 }
    ]}
  ];

  var controls = document.getElementById('dayControls');
  var panels = document.getElementById('panels');
  var map, markerLayer, currentMarkers = [];

  function currency(n){ return "$" + n.toFixed(0); }
  function daySum(obj){ var s=0,i; for(i=0;i<obj.steps.length;i++){ s += (obj.steps[i].budget||0); } return s; }
  function totalSum(){ var t=0,i; for(i=0;i<itinerary.length;i++){ t += daySum(itinerary[i]); } return t; }
  function getDay(d){ var i; for(i=0;i<itinerary.length;i++){ if(itinerary[i].day===d) return itinerary[i]; } return itinerary[0]; }

  function makeDayButton(obj, idx){
    var b = document.createElement('button');
    b.className = 'daybtn' + (idx===0?' active':'');
    b.textContent = 'DAY ' + obj.day;
    b.setAttribute('data-day', obj.day);
    b.onclick = function(){ activateDay(obj.day); };
    return b;
  }

  function makePanel(obj, idx){
    var wrap = document.createElement('div');
    wrap.className = 'panel card' + (idx===0?' active':'');
    var h = document.createElement('h2'); h.textContent = obj.title;
    var body = document.createElement('div'); body.className = 'body';
    var list = document.createElement('div'); list.className = 'list';

    var i;
    for(i=0;i<obj.steps.length;i++){
      var s = obj.steps[i];
      var item = document.createElement('div'); item.className = 'item';
      item.setAttribute('data-lat', s.lat); item.setAttribute('data-lng', s.lng);
      item.setAttribute('data-name', s.name); item.setAttribute('data-info', s.info);

      item.onmouseenter = function(e){
        var n = e.currentTarget.getAttribute('data-name');
        var info = e.currentTarget.getAttribute('data-info');
        showHover(n, info, parseFloat(e.currentTarget.getAttribute('data-lat')), parseFloat(e.currentTarget.getAttribute('data-lng')));
      };
      item.onmouseleave = function(){ hideHover(); };

      var left = document.createElement('div'); left.className = 'item-left';
      var dot = document.createElement('span'); dot.className = 'dot';

      var tx = document.createElement('div');
      var ttl = document.createElement('div'); ttl.className='title'; ttl.textContent = s.name;
      var mini = document.createElement('div'); mini.className='mini'; mini.textContent = s.info;
      tx.appendChild(ttl); tx.appendChild(mini);

      left.appendChild(dot); left.appendChild(tx);

      var right = document.createElement('div');
      var tag;
      if(s.budget && s.budget>0){
        tag = document.createElement('span'); tag.className='badge'; tag.textContent = currency(s.budget);
      }else{
        tag = document.createElement('span'); tag.className='badge free'; tag.textContent = 'Free';
      }
      right.appendChild(tag);

      item.appendChild(left); item.appendChild(right);
      list.appendChild(item);
    }

    var row = document.createElement('div'); row.className='row-sum';
    var chip = document.createElement('div'); chip.className='chip';
    chip.innerHTML = '<strong>일자 합계</strong> · <span class="sum">'+currency(daySum(obj))+'</span>';
    row.appendChild(chip);

    body.appendChild(list); body.appendChild(row);
    wrap.appendChild(h); wrap.appendChild(body);
    return wrap;
  }

  function buildUI(){
    var i;
    controls.innerHTML = '';
    panels.innerHTML = '';

    for(i=0;i<itinerary.length;i++){ controls.appendChild( makeDayButton(itinerary[i], i) ); }
    for(i=0;i<itinerary.length;i++){ panels.appendChild( makePanel(itinerary[i], i) ); }
  }

  function initMap(){
    map = L.map('map',{ zoomControl:true, scrollWheelZoom:true }).setView([13.511,144.805], 14);
    L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png',{ maxZoom:19, attribution:'© OpenStreetMap' }).addTo(map);
    markerLayer = L.layerGroup().addTo(map);
    currentMarkers = [];
  }

  function iconByType(t){
    var color = '#06b6d4';
    if(t==='bbq') color='#f59e0b';
    else if(t==='burger') color='#16a34a';
    else if(t==='poke') color='#0ea5e9';
    else if(t==='market') color='#a78bfa';
    else if(t==='hotel') color='#f472b6';
    else if(t==='pool') color='#60a5fa';
    else if(t==='beach') color='#34d399';
    else if(t==='spot') color='#ef4444';

    var html = '<svg xmlns="http://www.w3.org/2000/svg" width="26" height="26" viewBox="0 0 24 24" fill="'+color+'" stroke="black" stroke-width="0.5"><path d="M12 2c3.9 0 7 3.1 7 7 0 5.2-7 13-7 13S5 14.2 5 9c0-3.9 3.1-7 7-7zm0 9.5c1.4 0 2.5-1.1 2.5-2.5S13.4 6.5 12 6.5 9.5 7.6 9.5 9 10.6 11.5 12 11.5z"/></svg>';
    return L.divIcon({ html: html, className:'mkr', iconSize:[26,26], iconAnchor:[13,26], popupAnchor:[0,-20] });
  }

  function loadMarkers(day){
    markerLayer.clearLayers(); currentMarkers = [];
    var obj = getDay(day), bounds = [], i;
    for(i=0;i<obj.steps.length;i++){
      var s = obj.steps[i];
      var m = L.marker([s.lat, s.lng], { icon: iconByType(s.type), title: s.name }).addTo(markerLayer);
      m.bindPopup('<strong>'+s.name+'</strong><br>'+s.info);
      m.on('mouseover', function(e){
        e.target.openPopup();
        showHover(e.target.options.title, e.target.getPopup().getContent().replace(/<[^>]*>?/gm,''), e.target.getLatLng().lat, e.target.getLatLng().lng);
      });
      m.on('mouseout', function(){ hideHover(); });
      currentMarkers.push(m); bounds.push([s.lat, s.lng]);
    }
    if(bounds.length){ map.fitBounds(bounds, { padding:[28,28] }); }
  }

  function focusMarker(lat,lng){
    var i;
    for(i=0;i<currentMarkers.length;i++){
      var p = currentMarkers[i].getLatLng();
      if(Math.abs(p.lat-lat)<0.0009 && Math.abs(p.lng-lng)<0.0009){
        currentMarkers[i].openPopup();
        map.panTo([lat,lng], { animate:true, duration:.35 });
        break;
      }
    }
  }

  function renderBudget(day){
    var box = document.getElementById('budgetBox');
    var obj = getDay(day);
    var i, html = '';
    html += '<div class="row-sum">';
    for(i=0;i<obj.steps.length;i++){
      var s = obj.steps[i];
      if(s.budget && s.budget>0){
        html += '<div class="chip"><strong>'+s.name+'</strong> · '+currency(s.budget)+'</div>';
      }
    }
    html += '</div>';
    html += '<div class="row-sum"><div class="chip"><strong>DAY '+day+' 합계</strong> · <span class="sum">'+currency(daySum(obj))+'</span></div></div>';
    html += '<div class="row-sum"><div class="chip" style="background:#e8fff2;border-color:#bbf7d0"><strong>전체 합계</strong> · <span class="sum">'+currency(totalSum())+'</span></div></div>';
    box.innerHTML = html;
  }

  function showHover(title, text, lat, lng){
    var dock = document.getElementById('hoverDock');
    document.getElementById('hoverTitle').textContent = title;
    document.getElementById('hoverText').textContent = typeof text==='string' ? text : '';
    dock.classList.add('show');
    if(typeof lat==='number' && typeof lng==='number'){ focusMarker(lat, lng); }
  }
  function hideHover(){
    var dock = document.getElementById('hoverDock');
    dock.classList.remove('show');
  }

  function activateDay(day){
    var i, btns = document.querySelectorAll('.daybtn'), ps = document.querySelectorAll('.panel');
    for(i=0;i<btns.length;i++){
      if(parseInt(btns[i].getAttribute('data-day'),10)===day){ btns[i].classList.add('active'); }
      else{ btns[i].classList.remove('active'); }
    }
    for(i=0;i<ps.length;i++){
      if((i+1)===day){ ps[i].classList.add('active'); }
      else{ ps[i].classList.remove('active'); }
    }
    loadMarkers(day);
    renderBudget(day);
    hideHover();
  }

  function init(){
    buildUI();          /* 생성: 1회 */
    initMap();          /* 지도: 1회 */
    activateDay(1);     /* 초기 활성화 */
  }

  init(); /* DOM 끝에 스크립트가 있어 바로 실행해도 안전 */
</script>
</body>
</html>
